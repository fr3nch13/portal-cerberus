<?php

$page_options = array(
	'all' => $this->Html->link(__('All Events'), array(0 => 0)),
);
$page_subtitle = __('All');
foreach($reportsEvents as $reportsEvent_id => $reportsEvent_name)
{
	if($reports_event_id and $reports_event_id == $reportsEvent_id)
		$page_subtitle = $reportsEvent_name;
	
	$page_options['ReportsEvent.'. $reportsEvent_id] = $this->Html->link(__('Event: %s', $reportsEvent_name), array(0 => $reportsEvent_id));
}

$page_subtitle2 = false;
if($reports_event_id) 
	$page_subtitle2 = __('Trends are unavailable when viewing specific events.');

$dashboard_blocks = array();
//$dashboard_blocks['pen_test_results_desc'] = array('action' => 'db_block_desc');
$dashboard_blocks['pen_test_results_overview'] = array('action' => 'db_block_overview', $reports_event_id);
$dashboard_blocks['pen_test_db_tab_totals'] = array('action' => 'db_tab_totals', 'system', 2, $reports_event_id);
$dashboard_blocks['pen_test_db_tab_status_org'] = array('action' => 'db_tab_status', 'org', 1, $reports_event_id);
$dashboard_blocks['pen_test_db_tab_gssparent'] = array('action' => 'db_tab_gssparent', $reports_event_id);
$dashboard_blocks['pen_test_db_block_status_trend'] = array('action' => 'db_block_status_trend', $reports_event_id);
$dashboard_blocks['pen_test_db_tab_assignable_party_org'] = array('action' => 'db_tab_assignable_party', 'org', 1, $reports_event_id);
$dashboard_blocks['pen_test_db_tab_remediation_org'] = array('action' => 'db_tab_remediation', 'org', 1, $reports_event_id);
$dashboard_blocks['pen_test_db_tab_verification_org'] = array('action' => 'db_tab_verification', 'org', 1, $reports_event_id);
$dashboard_blocks['pen_test_db_block_assignable_party_trend'] = array('action' => 'db_block_assignable_party_trend', $reports_event_id);
$dashboard_blocks['pen_test_db_block_remediation_trend'] = array('action' => 'db_block_remediation_trend', $reports_event_id);
$dashboard_blocks['pen_test_db_block_verification_trend'] = array('action' => 'db_block_verification_trend', $reports_event_id);
$dashboard_blocks['pen_test_db_tab_severity_org'] = array('action' => 'db_tab_severity', 'org', 1, $reports_event_id);
$dashboard_blocks['pen_test_db_block_severity_trend'] = array('action' => 'db_block_severity_trend', $reports_event_id);

$tabs = array();

$tabs['results'] = array(
	'id' => 'results',
	'name' => __('All Results'), 
	'ajax_url' => array('action' => 'db_tab_index', 0, $reports_event_id),
);
$tabs['breakout'] = array(
	'id' => 'breakout',
	'name' => __('Breakout List'), 
	'ajax_url' => array('action' => 'db_tab_breakout', 'org', 0, $reports_event_id),
);
$tabs['assignable_party'] = array(
	'id' => 'assignable_party',
	'name' => __('%s Counts', __('Assignable Party')), 
	'ajax_url' => array('action' => 'db_tab_assignable_party', 'org', 0, $reports_event_id),
);
$tabs['remediation'] = array(
	'id' => 'remediation',
	'name' => __('%s Counts', __('Remediation')), 
	'ajax_url' => array('action' => 'db_tab_remediation', 'org', 0, $reports_event_id),
);
$tabs['severity'] = array(
	'id' => 'severity',
	'name' => __('%s Counts', __('Severity')), 
	'ajax_url' => array('action' => 'db_tab_severity', 'org', 0, $reports_event_id),
);
$tabs['status'] = array(
	'id' => 'status',
	'name' => __('%s Counts', __('Status')), 
	'ajax_url' => array('action' => 'db_tab_status', 'org', 0, $reports_event_id),
);
$tabs['verification'] = array(
	'id' => 'verification',
	'name' => __('%s Counts', __('Verification')), 
	'ajax_url' => array('action' => 'db_tab_verification', 'org', 0, $reports_event_id),
);
$tabs['orphans'] = array(
	'id' => 'orphans',
	'name' => __('Orphans'), 
	'ajax_url' => array('action' => 'orphans', $reports_event_id),
);
$tabs['trend'] = array(
	'id' => 'trend',
	'name' => __('Reports Trending'), 
	'ajax_url' => array('controller' => 'pen_test_reports', 'action' => 'db_tab_trend', $reports_event_id),
);
$tabs['crossovers'] = array(
	'id' => 'crossovers',
	'name' => __('Crossovers'), 
	'ajax_url' => array('action' => 'db_tab_crossovers', 'org', 0, $reports_event_id),
);

echo $this->element('Utilities.page_dashboard', array(
	'page_title' => __('Dashboard: %s', __('Penetration Tests')),
	'page_subtitle' => __('Event: %s', $page_subtitle),
	'page_subtitle2' => $page_subtitle2,
	'page_options_html' => $this->element('dashboard_options'),
	'page_options_title' => __('View By %s', __('Event')),
	'page_options' => $page_options,
	'dashboard_blocks' => $dashboard_blocks,
	'tabs' => $tabs,
));